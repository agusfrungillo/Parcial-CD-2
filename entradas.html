<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Entradas – Game Awards</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="checkout-mode">

  <div class="nav-checkout">
    <div class="logo"><a href="index.html"><img src="img/logo.png" alt="Logo"></a></div>
    <a href="index.html" class="nav-back"><i class="fa-solid fa-arrow-left me-2"></i> Inicio</a>
  </div>

  <div class="checkout-wrapper">
    <div class="checkout-container row g-5">
      
      <div class="col-lg-7">
        <div class="d-flex align-items-center justify-content-between mb-4">
          <h2 class="h4 m-0 text-white" id="step-title">Elegí tu Entrada</h2>
          <div class="step-indicator">
            <div class="step active" id="s1">1</div>
            <div class="step" id="s2">2</div>
            <div class="step" id="s3">3</div>
          </div>
        </div>

        <div id="step1" class="form-section active form-card">
          <label class="ticket-option selected" onclick="selectTicket(50000, 'Entrada General')">
            <input type="radio" name="ticket" checked>
            <div><strong>General</strong><small class="d-block text-secondary">Platea alta + Kit básico.</small></div>
            <span class="text-warning fw-bold">$50.000</span>
          </label>
          <label class="ticket-option" onclick="selectTicket(120000, 'Premium')">
            <input type="radio" name="ticket">
            <div><strong>Premium</strong><small class="d-block text-secondary">Butaca pref. + Red Carpet.</small></div>
            <span class="text-warning fw-bold">$120.000</span>
          </label>
          <label class="ticket-option" onclick="selectTicket(180000, 'VIP Experience')">
            <input type="radio" name="ticket">
            <div><strong>VIP Experience</strong><small class="d-block text-secondary">Fiesta post-evento y meet & greets.</small></div>
            <span class="text-warning fw-bold">$180.000</span>
          </label>
          <div class="mt-4">
            <label class="form-label">Cantidad</label>
            <select class="form-control form-control-dark w-25" id="cantidad" onchange="updateTotal()"><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
          </div>

          <div class="summary-card mt-4 mb-4 d-lg-none">
             <h5 class="text-warning border-bottom border-secondary pb-2 mb-2">Resumen</h5>
             <div class="d-flex justify-content-between text-white mb-2"><span class="summ-name">Entrada General</span><span>x<span class="summ-qty">1</span></span></div>
             <div class="d-flex justify-content-between border-top border-secondary pt-2 mt-2"><span class="text-white">Total</span><span class="fw-bold text-warning summ-total">$50.000</span></div>
          </div>

          <div class="mt-4 text-end"><button class="btn btn-checkout" onclick="goStep(2)">Siguiente</button></div>
        </div>

        <div id="step2" class="form-section form-card">
          <h5 class="mb-4 pb-2 border-bottom border-secondary text-white">Tus Datos</h5>
          <div class="row g-3">
            <div class="col-12 col-md-6">
              <label class="form-label">Nombre</label>
              <input type="text" class="form-control form-control-dark" id="nombre" oninput="onlyLetters(this)">
              <div class="error-msg">Este campo es obligatorio</div>
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label">Apellido</label>
              <input type="text" class="form-control form-control-dark" id="apellido" oninput="onlyLetters(this)">
              <div class="error-msg">Este campo es obligatorio</div>
            </div>
            <div class="col-12">
              <label class="form-label">Email</label>
              <input type="email" class="form-control form-control-dark" id="email">
              <div class="error-msg">Ingresá un email válido (@)</div>
            </div>
          </div>

          <div class="summary-card mt-4 mb-4 d-lg-none">
             <div class="d-flex justify-content-between border-top border-secondary pt-2 mt-2"><span class="text-white">Total a Pagar</span><span class="fw-bold text-warning summ-total">$50.000</span></div>
          </div>

          <div class="mt-4 d-flex justify-content-between align-items-center">
            <button class="btn btn-outline-secondary rounded-pill btn-sm px-4" onclick="goStep(1)">Atrás</button>
            <button class="btn btn-checkout" onclick="goStep(3)">Ir al Pago</button>
          </div>
        </div>

        <div id="step3" class="form-section form-card">
          <h5 class="mb-4 pb-2 border-bottom border-secondary text-white">Pago Seguro</h5>
          <div class="mb-3">
            <label class="form-label">Tarjeta</label>
            <input type="text" class="form-control form-control-dark" id="tarjeta" placeholder="0000 0000 0000 0000" maxlength="19" oninput="formatCard(this)">
            <div class="error-msg">Número de tarjeta inválido</div>
          </div>
          <div class="row g-3">
            <div class="col-12 col-md-6">
              <label class="form-label">Titular</label>
              <input type="text" class="form-control form-control-dark" id="titular" oninput="onlyLetters(this)">
              <div class="error-msg">Campo obligatorio</div>
            </div>
            <div class="col-12 col-md-3">
              <label class="form-label">Venc.</label>
              <input type="text" class="form-control form-control-dark" id="venc" placeholder="MM/AA" maxlength="5" oninput="formatDate(this)">
              <div class="error-msg">Incompleto</div>
            </div>
            <div class="col-12 col-md-3">
              <label class="form-label">CVV</label>
              <input type="text" class="form-control form-control-dark" id="cvv" placeholder="123" maxlength="3" oninput="onlyNumbers(this)">
              <div class="error-msg">3 dígitos</div>
            </div>
          </div>
          
          <div class="summary-card mt-4 mb-4 d-lg-none">
             <div class="d-flex justify-content-between border-top border-secondary pt-2 mt-2"><span class="text-white">Total a Pagar</span><span class="fw-bold text-warning summ-total">$50.000</span></div>
          </div>

          <div class="mt-4 d-flex justify-content-between align-items-center">
            <button class="btn btn-outline-secondary rounded-pill btn-sm px-4" onclick="goStep(2)">Atrás</button>
            <button class="btn btn-checkout" onclick="finish()">Confirmar</button>
          </div>
        </div>

        <div id="step4" class="form-section form-card text-center py-5">
          <i class="fa-solid fa-check-circle text-success mb-3" style="font-size: 4rem;"></i>
          <h3 class="text-white">¡Listo!</h3>
          <p class="text-center">Tus entradas han sido enviadas.</p>
          <a href="index.html" class="btn btn-outline-light rounded-pill mt-3 btn-sm px-4">Inicio</a>
        </div>
      </div>

      <div class="col-lg-5 d-none d-lg-block">
        <div class="summary-card">
          <h5 class="text-warning border-bottom border-secondary pb-3 mb-3">Resumen</h5>
          <div class="d-flex justify-content-between text-white mb-2">
            <span class="summ-name">Entrada General</span>
            <span>x<span class="summ-qty">1</span></span>
          </div>
          <div class="d-flex justify-content-between border-top border-secondary pt-3 mt-3">
            <span class="text-white fs-5">Total</span>
            <span class="fw-bold fs-4 text-warning summ-total">$50.000</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-container">
      <div class="footer-left"><p>© 2025 The Game Awards</p></div>
      <div class="footer-logo"><img src="img/logo.png" alt="Logo"></div>
    </div>
  </footer>

  <script>
    let price=50000, name="Entrada General";

    // --- VALIDACIONES ---
    function showError(input, msg) {
      const errorDiv = input.nextElementSibling;
      if (errorDiv && errorDiv.classList.contains('error-msg')) {
        errorDiv.innerText = msg;
        errorDiv.classList.add('visible');
      }
      input.classList.add('error');
    }

    function clearError(input) {
      const errorDiv = input.nextElementSibling;
      if (errorDiv) errorDiv.classList.remove('visible');
      input.classList.remove('error');
    }

    // Solo numeros
    function onlyNumbers(input) {
      input.value = input.value.replace(/[^0-9]/g, '');
      clearError(input);
    }

    // Solo letras
    function onlyLetters(input) {
      input.value = input.value.replace(/[^a-zA-Z\s]/g, '');
      clearError(input);
    }

    // Formato Tarjeta (espacios cada 4)
    function formatCard(input) {
      let val = input.value.replace(/\D/g, '');
      val = val.replace(/(\d{4})/g, '$1 ').trim();
      input.value = val;
      clearError(input);
    }

    // Formato Fecha MM/AA
    function formatDate(input) {
      let val = input.value.replace(/\D/g, '');
      if (val.length >= 2) {
        val = val.substring(0, 2) + '/' + val.substring(2, 4);
      }
      input.value = val;
      clearError(input);
    }

    // VALIDACION PRINCIPAL DEL PASO
    function validateStep(stepId) {
      let isValid = true;
      const inputs = document.getElementById(stepId).querySelectorAll('input');
      
      inputs.forEach(input => {
        if (input.type === 'radio') return; // Ignorar radios

        // Chequeo vacio
        if (input.value.trim() === '') {
          showError(input, 'Este campo es obligatorio');
          isValid = false;
        } else {
          // Chequeos especificos
          if (input.id === 'email' && !input.value.includes('@')) {
            showError(input, 'Por favor ingresar un correo valido');
            isValid = false;
          }
          else if (input.id === 'tarjeta' && input.value.length < 19) {
            showError(input, 'Incompleto');
            isValid = false;
          }
          else if (input.id === 'cvv' && input.value.length < 3) {
            showError(input, 'Revisar informacion brindada');
            isValid = false;
          }
          else if (input.id === 'venc' && input.value.length < 5) {
            showError(input, 'Formato MM/AA');
            isValid = false;
          } else {
            clearError(input);
          }
        }
      });
      return isValid;
    }

    // --- LOGICA DE PASOS ---
    function selectTicket(p, n) { 
      price = p; name = n; 
      document.querySelectorAll('.ticket-option').forEach(e => e.classList.remove('selected'));
      event.currentTarget.classList.add('selected'); event.currentTarget.querySelector('input').checked = true;
      updateTotal();
    }

    function updateTotal() {
      let qty = document.getElementById('cantidad').value;
      document.querySelectorAll('.summ-name').forEach(el => el.innerText = name);
      document.querySelectorAll('.summ-qty').forEach(el => el.innerText = qty);
      document.querySelectorAll('.summ-total').forEach(el => el.innerText = "$" + (price * qty).toLocaleString('es-AR'));
    }

    function goStep(targetStep) {
      // Identificar paso actual para validar antes de avanzar
      let currentStepNum = targetStep - 1;
      let currentStepId = 'step' + currentStepNum;

      // Si vamos para adelante (target > current), validamos
      // Nota: Si targetStep es 4 (final), validamos el 3.
      if (targetStep > 1 && targetStep <= 4) {
         // Si voy del 1 al 2, no hay inputs que validar (solo radio y select que siempre tienen valor)
         if (currentStepNum > 1) { 
            if (!validateStep(currentStepId)) return; // Bloquear si falla
         }
      }

      // Cambio de vista
      document.querySelectorAll('.form-section').forEach(e => e.classList.remove('active'));
      document.getElementById('step'+targetStep).classList.add('active');
      
      // Indicadores
      document.querySelectorAll('.step').forEach(e => e.classList.remove('active'));
      if(targetStep<=3) document.getElementById('s'+targetStep).classList.add('active');
      
      if(targetStep==2) document.getElementById('s1').classList.add('completed');
      if(targetStep==3) { document.getElementById('s1').classList.add('completed'); document.getElementById('s2').classList.add('completed'); }
    }

    function finish() { 
      if (!validateStep('step3')) return;
      goStep(4); 
      document.querySelector('.step-indicator').style.display='none'; 
      document.getElementById('step-title').innerText = "Confirmación"; 
    }
  </script>
</body>
</html>
